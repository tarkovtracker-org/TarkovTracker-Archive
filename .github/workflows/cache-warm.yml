name: Cache Warm

on:
  push:
    branches: [main]
  schedule:
    # Run nightly at 2 AM UTC to keep caches warm
    - cron: '0 2 * * *'

# Principle of least privilege: only grant necessary permissions
permissions:
  contents: read # Read repository contents for checkout

jobs:
  warm-root-cache:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Setup and install root dependencies
        uses: ./.github/actions/setup-node-and-install
        with:
          node-version: '22'
          working-directory: '.'

  warm-frontend-cache:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Setup and install frontend dependencies
        uses: ./.github/actions/setup-node-and-install
        with:
          node-version: '22'
          working-directory: './frontend'
